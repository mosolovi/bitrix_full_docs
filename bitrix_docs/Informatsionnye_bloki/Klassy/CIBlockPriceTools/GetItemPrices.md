[Информационные блоки](/api_help/iblock/index.php)

[Классы](/api_help/iblock/classes/index.php)

[CIBlockPriceTools](/api_help/iblock/classes/ciblockpricetools/index.php)

GetItemPrices (доступен с 5.9.0)

GetItemPrices
=============

Включить вкладки

Описание и параметры

Возвращаемое значение

### Описание и параметры

```
array CIBlockPriceTools::GetItemPrices(
	int IBLOCK_ID, 
	array arCatalogPrices, 
	array arItem, 
	bool bVATInclude = true, 
	array arCurrencyParams = array(),
	int USER_ID = 0, 
	string LID = SITE_ID
)Копировать
```

Метод возвращает рассчитанные с учетом скидок (если это торговый каталог) цены для элемента. Метод статический.

#### Параметры вызова

| Параметр | Описание | С версии |
| --- | --- | --- |
| IBLOCK\_ID | Идентификатор инфоблока элемента. В действительности в коде сейчас не используется. |  |
| arCatalogPrices | Массив с данными, зависящий от редакции продукта:  * если редакция с модулем **Торговый каталог**, то это массив типов цен, которые вернул метод [CIBlockPriceTools::GetCatalogPrices](/api_help/iblock/classes/ciblockpricetools/getcatalogprices.php). * если редакция без модуля **Торговый каталог**, то это массив свойств, которые вернул метод [CIBlockPriceTools::GetCatalogPrices](/api_help/iblock/classes/ciblockpricetools/getcatalogprices.php). |  |
| arItem | Элемент инфоблока, который был получен с помощью [CIBlockElement::GetList](/api_help/iblock/classes/ciblockelement/getlist.php):  * для редакций с модулем **Торговый каталог** в элементе должны присутствовать данные по ценам. * для редакций без модуля **Торговый каталог** - свойства типа **Число**, упомянутые в [CIBlockPriceTools::GetCatalogPrices](/api_help/iblock/classes/ciblockpricetools/getcatalogprices.php). |  |
| bVATInclude | (*true/false*) Флаг определяет включать ли НДС в цену, если он не был включен. | 7.0.0 |
| arCurrencyParams | Массив параметров, отвечающий за конвертацию цен в одну валюту. | 11.5.1 |
| USER\_ID | Идентификатор пользователя (если отсутствует или равен нулю, то группы берутся для текущего пользователя, а если задан, то рассчитываются для этого конкретного пользователя). Параметр влияет на выборку скидок. Необязательный. | 12.0.0 |
| LID | Идентификатор сайта, для которого ведутся расчеты (если не задан, то берется текущий сайт). Параметр влияет на выборку скидок. Необязательный. | 12.0.0 |

### Возвращаемое значение

Возвращает массив. В случае ошибки или отсутствия доступных типов цен (ни купить, ни посмотреть либо сами цены не заданы) массив будет пустым. В случае успешного выполнения вернется массив следующей структуры:

1. Для редакций с модулем **Торговый каталог**:

   Ключ - код типа цены. Значение - массив с полями:

   * **ID** - идентификатор ценового предложения;
   * **PRICE\_ID** - идентификатор типа цены;
   * **CAN\_ACCESS** - (*true/false*) флаг определяющий возможность просмотра цены этого типа;
   * **CAN\_BUY** - (*true/false*) флаг определяющий возможность покупки по цене этого типа;
   * **MIN\_PRICE** - (*Y/N*) значение *Y* задается для наименьшей из цен, которые можно хотя бы смотреть;
   * **VALUE\_NOVAT** - значение цены без НДС;
   * **PRINT\_VALUE\_NOVAT** - отформатированное значение цены без НДС;
   * **VALUE\_VAT** - цена с НДС;
   * **PRINT\_VALUE\_VAT** - отформатированная цена с НДС;
   * **VATRATE\_VALUE** - абсолютная величина НДС (не проценты);
   * **PRINT\_VATRATE\_VALUE** - отформатированная абс. величина НДС;
   * **DISCOUNT\_VALUE\_NOVAT** - цена со скидкой без НДС;
   * **PRINT\_DISCOUNT\_VALUE\_NOVAT** - отформатированная цена со скидкой без НДС;
   * **DISCOUNT\_VALUE\_VAT** - НДС скидки;
   * **PRINT\_DISCOUNT\_VALUE\_VAT** - отформатированный НДС скидки;
   * **DISCOUNT\_VATRATE\_VALUE** - цена со скидкой с НДС;
   * **PRINT\_DISCOUNT\_VATRATE\_VALUE** - отформатированная цена со скидкой с НДС;
   * **CURRENCY** - код валюты;
   * следующие параметры зависят от значения параметра *$bVATInclude*. Если он принимает значение *true*, то в них копируются данные с включенным НДС, если нет - без НДС:
     + **VALUE** - цена для вывода;
     + **PRINT\_VALUE** - отформатированная цена для вывода;
     + **DISCOUNT\_VALUE** - цена со скидкой;
     + **PRINT\_DISCOUNT\_VALUE** - отформатированная цена со скидкой;
     + **DISCOUNT\_DIFF** - величина скидки;
     + **DISCOUNT\_DIFF\_PERCENT** - процент скидки с округлением до целого
     + **PRINT\_DISCOUNT\_DIFF** - отформатированная величина скидки;
   * в случае, когда включено приведение к одной валюте и исходная валюта не равна той, в которую надо сконвертировать, появляются ключи с префиксом **ORIG\_**. Такие ключи содержат исходные данные.
2. Для редакций без модуля **Торговый каталог** конвертация валют и НДС не используются:

   Ключ - символьный код свойства. Значение - массив с полями:

   * **CURRENCY** - берется из **DESCRIPTION** (описания) значения свойства;
   * **CAN\_ACCESS** - всегда *true*;
   * **CAN\_BUY** - всегда *false*;
   * **PRICE\_ID** - идентификатор свойства;
   * **ID** - идентификатор значения свойства;
   * **VALUE** - значение свойства;
   * **PRINT\_VALUE** - значение свойства и значение описания (типа валюта);
   * **DISCOUNT\_VALUE** - всегда *VALUE*;
   * **PRINT\_DISCOUNT\_VALUE** - всегда *PRINT\_VALUE*;
   * **MIN\_PRICE** - Y для минимального из значений свойств;
   * **DISCOUNT\_DIFF\_PERCENT** - всегда *0*;
   * **DISCOUNT\_DIFF** - всегда *0*;
   * **PRINT\_DISCOUNT\_DIFF** - всегда *0* и описание значения (типа валюта).

Новинки документации в соцсетях: