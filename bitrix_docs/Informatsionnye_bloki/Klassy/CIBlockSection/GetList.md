[Информационные блоки](/api_help/iblock/index.php)

[Классы](/api_help/iblock/classes/index.php)

[CIBlockSection](/api_help/iblock/classes/ciblocksection/index.php)

GetList (доступен с 3.0.6)

GetList
=======

Включить вкладки

Описание

Параметры вызова

Примеры использования

### Описание

```
CIBlockResult
CIBlockSection::GetList(
	array arOrder = Array("SORT"=>"ASC"),
	array arFilter = Array(),
	bool bIncCnt = false,
	array Select = Array(),
	array NavStartParams = false
);Копировать
```

Возвращает список разделов, отсортированных в порядке *arOrder* по фильтру *arFilter*. Нестатический метод.

#### Смотрите также

* [CIBlockResult](/api_help/iblock/classes/ciblockresult/index.php)
* [Поля раздела информационного блока](/api_help/iblock/fields.php#fsection)

### Параметры вызова

| Параметр | Описание | С версии |
| --- | --- | --- |
| arOrder | Массив для сортировки, имеющий вид *by1*=>*order1*[, *by2*=>*order2* [, ..]], где  *by1, ...*  - поле сортировки, может принимать значения:  * **id** - код раздела; * **section** - код родительской раздела; * **name** - название раздела; * **code** - символьный код раздела; * **active** - активности раздела; * **left\_margin** - левая граница; * **depth\_level** - глубина вложенности (начинается с 1); * **sort** - индекс сортировки; * **created** - по времени создания раздела; * **created\_by** - по идентификатору создателя раздела; * **modified\_by** - по идентификатору пользователя изменившего раздел; * **element\_cnt** - количество элементов в разделе, работает только если **bIncCnt** = true; * **timestamp\_x** - по времени последнего изменения.  *order1, ...*  - порядок сортировки, может принимать значения:  * **asc** - по возрастанию; * **desc** - по убыванию.    Кроме того, сортировка возможна и по пользовательским свойствам UF\_XXX.    Значение по умолчанию Array("SORT"=>"ASC") означает, что результат выборки будет отсортирован по возрастанию. Если задать пустой массив Array(), то результат отсортирован не будет. |  |
| arFilter | Массив вида array("фильтруемое поле"=>"значение" [, ...]). *Фильтруемое поле* может принимать значения:  * **ACTIVE** - фильтр по активности (Y|N); * **GLOBAL\_ACTIVE** - фильтр по активности, учитывая активность вышележащих разделов (Y|N); * **NAME** - по названию (можно искать по шаблону [%\_]); * **CODE** - по символьному коду (по шаблону [%\_]); * **XML\_ID** или **EXTERNAL\_ID** - по внешнему коду (по шаблону [%\_]); * **SECTION\_ID** - по коду раздела-родителя (если указать false, то будут возвращены корневые разделы); * **DEPTH\_LEVEL** - по уровню вложенности (начинается с 1); * **LEFT\_BORDER**,  **RIGHT\_BORDER** - по левой и правой границе (используется, когда необходимо выбрать некий диапазон разделов, см. [пример №4](#ex4)); * **LEFT\_MARGIN**, **RIGHT\_MARGIN** - по положению в дереве (используется, когда необходима выборка дерева подразделов, см. [пример №4](#ex4)); * **ID** - по коду раздела; * **IBLOCK\_ID** - по коду родительского информационного блока. Обязателен, если нужно получить пользовательское свойство; * **IBLOCK\_ACTIVE** - по активности родительского информационного блока; * **IBLOCK\_NAME** - по названию информационного блока (по шаблону [%\_]); * **IBLOCK\_TYPE** - по типу информационного блока (по шаблону [%\_]); * **IBLOCK\_CODE**  *-* по символьному коду информационного блока (по шаблону [%\_]); * **IBLOCK\_XML\_ID** или **IBLOCK\_EXTERNAL\_ID** - по внешнему коду информационного блока (по шаблону [%\_]); * TIMESTAMP\_X - по времени последнего изменения; * DATE\_CREATE - по времени создания; * MODIFIED\_BY - по коду пользователя изменившему раздел; * CREATED\_BY - по содателю; * SOCNET\_GROUP\_ID - по привязке к группе Социальной сети; * **MIN\_PERMISSION** - фильтр по правам доступа, по умолчанию принимает *R* (уровень доступа *Чтение*); * **CHECK\_PERMISSIONS** - если установлено значение "N", то проверки прав не происходит; * **PERMISSIONS\_BY** - фильтрация по правам произвольного пользователя. Значение - ID пользователя или 0 (неавторизованный). * **PROPERTY**  *-* по значениям свойств внутрилежащих элементов, PROPERTY - массив вида Array("код свойства"=>"значение", ...). * **HAS\_ELEMENT** - по наличию элемента. Используется в компоненте **catalog.detail**.  Все фильтруемые поля могут содержать перед названием [тип проверки фильтра](http://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=43&LESSON_ID=2683).     ***Значения фильтра*** одиночное значение или массив.     **Важно!** Чтобы фильтрация выполнялась по пользовательским свойствам, необходимо обязательно передавать в фильтр *IBLOCK\_ID*. Само свойство надо указывать в виде UF\_...   Необязательное. По умолчанию записи не фильтруются. |  |
| bIncCnt | Возвращать ли поле *ELEMENT\_CNT* - количество элементов в разделе. При этом arFilter дополнительно обрабатывает следующие фильтруемые поля:  * **ELEMENT\_SUBSECTIONS** - подсчитывать элементы вложенных подразделов или нет (Y|N). По умолчанию Y; * **CNT\_ALL** - подсчитывать еще неопубликованные элементы (Y|N). По умолчанию N. Актуально при установленном модуле документооборота; * **CNT\_ACTIVE** - при подсчете учитывать активность элементов (Y|N). По умолчанию N. Учитывается флаг активности элемента ACTIVE и даты начала и окончания активности.  Необязательный параметр, по умолчанию равен false. **Примечание:** в случае если в фильтре есть ключ PROPERTY то в количестве элементов вернется то значение, которое попадает под этот фильтр по значению свойств. |  |
| arSelect | Массив для выборки.  * **ID** - ID группы информационного блока. * **CODE** - Символьный идентификатор. * **EXTERNAL\_ID или XML\_ID** - Внешний код. * **IBLOCK\_ID** - ID информационного блока. * **IBLOCK\_SECTION\_ID** - ID группы родителя, если не задан то группа корневая. * **TIMESTAMP\_X** - Дата последнего изменения параметров группы. * **SORT** - Порядок сортировки (среди групп внутри одной группы-родителя). * **NAME** - Наименование группы. * **ACTIVE** - Флаг активности (Y|N) * **GLOBAL\_ACTIVE** - Флаг активности, учитывая активность вышележащих (родительских) групп (Y|N). Вычисляется автоматически (не может быть изменен вручную). * **PICTURE** - Код картинки в таблице файлов. * **DESCRIPTION** - Описание группы. * **DESCRIPTION\_TYPE** - Тип описания группы (text/html). * **LEFT\_MARGIN** - Левая граница группы. Вычисляется автоматически (не устанавливается вручную). * **RIGHT\_MARGIN** - Правая граница группы. Вычисляется автоматически (не устанавливается вручную). * **DEPTH\_LEVEL** - Уровень вложенности группы. Начинается с 1. Вычисляется автоматически (не устанавливается вручную). * **SEARCHABLE\_CONTENT** Содержимое для поиска при фильтрации групп. Вычисляется автоматически. Складывается из полей **NAME** и **DESCRIPTION** (без html тэгов, если **DESCRIPTION\_TYPE** установлен в html). * **SECTION\_PAGE\_URL** - Шаблон URL-а к странице для детального просмотра раздела. Определяется из параметров информационного блока. Изменяется автоматически. * **MODIFIED\_BY** - Код пользователя, в последний раз изменившего элемент. * **DATE\_CREATE** - Дата создания элемента. * **CREATED\_BY** - Код пользователя, создавшего элемент. * **DETAIL\_PICTURE** - Код картинки в таблице файлов для детального просмотра.  Кроме того, можно вывести пользовательские свойства, если задать их код (см. примечание ниже). | 6.0.3 |
| arNavStartParams | Массив для постраничной навигации. Может содержать следующие ключи:  * **bShowAll** - разрешить вывести все элементы при постраничной навигации; * **iNumPage** - номер страницы при постраничной навигации; * **nPageSize** - количество элементов на странице при постраничной навигации; * **nTopCount** - ограничить количество возвращаемых методом записей сверху значением этого ключа (ключ доступен с версии **15.5.5** ).  Если в параметр передать пустой массив, то результат выборки будет ограничен десятью записями. А если передать значение *false* - то выборка будет полной. | 11.0.0 |

#### Возвращаемое значение

Возвращается объект [CIBlockResult](/api_help/iblock/classes/ciblockresult/index.php)

**Примечание №1:** для вывода пользовательских свойств обязательно должен быть передан *IBLOCK\_ID* и в arSelect код необходимых свойств *UF\_XXX*. Если необходимо вывести все пользовательские свойства, то в arSelect необходимо передать *UF\_\**.

**Примечание №2:** поле для сортировки *left\_margin*, так называемая "сквозная" сортировка, высчитывается на основании поля *sort*, уровня вложенности и сортировкой верхнего уровня. Отличие полей *sort* и *left\_margin* в том, что *sort* указывается пользователем, для сортировки разделов между собой в пределах одного раздела-родителя, а вычисляемое *left\_margin* предназначено для сортировки во всем информационном блоке.

**Примечание №3:** нет возможности фильтровать разделы в выборке по количеству элементов.

#### Дополнительно

Выбор пользовательских свойств разделов возможен только при передаче в ключ фильтра IBLOCK\_ID одиночного значения.

### Примеры использования

Пример 1:

```
<?
$arIBTYPE = CIBlockType::GetByIDLang($type, LANGUAGE_ID);
if($arIBTYPE!==false)
{
	// выборка только активных разделов из инфоблока $IBLOCK_ID, в которых есть элементы 
	// со значением свойства SRC, начинающееся с https://
	$arFilter = Array('IBLOCK_ID'=>$IBLOCK_ID, 'GLOBAL_ACTIVE'=>'Y', 'PROPERTY'=>Array('SRC'=>'https://%'));
	$db_list = CIBlockSection::GetList(Array($by=>$order), $arFilter, true);
	$db_list->NavStart(20);
	echo $db_list->NavPrint($arIBTYPE["SECTION_NAME"]);
	while($ar_result = $db_list->GetNext())
	{
		echo $ar_result['ID'].' '.$ar_result['NAME'].': '.$ar_result['ELEMENT_CNT'].'<br>';
	}
	echo $db_list->NavPrint($arIBTYPE["SECTION_NAME"]);
}
?>Копировать
```

Пример 2:

```
//пример выборки дерева подразделов для раздела 
$rsParentSection = CIBlockSection::GetByID(ID_необходимой_секции);
if ($arParentSection = $rsParentSection->GetNext())
{
	$arFilter = array('IBLOCK_ID' => $arParentSection['IBLOCK_ID'],'>LEFT_MARGIN' => $arParentSection['LEFT_MARGIN'],'<RIGHT_MARGIN' => $arParentSection['RIGHT_MARGIN'],'>DEPTH_LEVEL' => $arParentSection['DEPTH_LEVEL']); // выберет потомков без учета активности
	$rsSect = CIBlockSection::GetList(array('left_margin' => 'asc'),$arFilter);
	while ($arSect = $rsSect->GetNext())
	{
		// получаем подразделы
	}
}Копировать
```

Пример 3:

```
//в шаблоне меню, построенного по структуре инфоблока, менять ссылку на элемент, если заполнено пользовательское поле 
<? 
//внутри цикла построения меню
$uf_iblock_id = 1; //ID инфоблока
$uf_name = Array("UF_PAGE_LINK"); //пользовательское поле UF_PAGE_LINK
preg_match('/\?ID=([0-9]+)\&?/i', $arItem["LINK"], $matches); //SEF отключен, поэтому спокойно берем SECTION_ID из ссылки по шаблону ID=#SECTION_ID#
$uf_section_id = $matches[1];
if(CModule::IncludeModule("iblock")): //подключаем модуль инфоблок для работы с классом CIBlockSection
	$uf_arresult = CIBlockSection::GetList(Array("SORT"=>"­­ASC"), Array("IBLOCK_ID" => $uf_iblock_id, "ID" => $uf_section_id), false, $uf_name);
	if($uf_value = $uf_arresult->GetNext()):
		if(strlen($uf_value["UF_PAGE_LINK"]) > 0): //проверяем что поле заполнено
			$arItem["LINK"] = $uf_value["UF_PAGE_LINK"]; //подменяем ссылку и используем её в дальнейшем
		endif;
	endif;
endif;
?> Копировать
```

Пример 4:

```
//рассмотрим разницу использования фильтра по LEFT_MARGIN, RIGHT_MARGIN и LEFT_BORDER, RIGHT_BORDER
//допустим, что у некоторого раздела LEFT_MARGIN (значение в базе) = 10, RIGHT_MARGIN (значение в базе) = 40
//в первом примере кода будет выбран как сам раздел, так и все его подразделы,
//поскольку всегда LEFT_MARGIN раздела-потомка > LEFT_MARGIN раздела-родителя
//и RIGHT_MARGIN раздела-потомка < RIGHT_MARGIN раздела-родителя
$arFilter = array('IBLOCK_ID' => 10, 'LEFT_MARGIN' => 10, 'RIGHT_MARGIN' => 40);
$rsSections = CIBlockSection::GetList(array('LEFT_MARGIN' => 'ASC'), $arFilter);
while ($arSection = $rsSections->Fetch())
{
	echo htmlspecialcharsbx($arSection['NAME']).' LEFT_MARGIN: '.$arSection['LEFT_MARGIN'].' RIGHT_MARGIN: '.$arSection['RIGHT_MARGIN'].'<br>';
}
//во втором примере кода будет возвращена только одна запись - сам раздел
$arFilter = array('IBLOCK_ID' => 10, 'LEFT_BORDER' => 10, 'RIGHT_BORDER' => 40);
$rsSections = CIBlockSection::GetList(array('LEFT_MARGIN' => 'ASC'), $arFilter);
while ($arSction = $rsSections->Fetch())
{
	echo htmlspecialcharsbx($arSection['NAME']).' LEFT_MARGIN: '.$arSection['LEFT_MARGIN'].' RIGHT_MARGIN: '.$arSection['RIGHT_MARGIN'].'<br>';
}Копировать
```

Новинки документации в соцсетях: