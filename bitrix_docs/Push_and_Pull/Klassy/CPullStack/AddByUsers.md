[Push and Pull](/api_help/push_pull/index.php)

[Классы](/api_help/push_pull/classes/index.php)

[CPullStack](/api_help/push_pull/classes/cpullstack/index.php)

AddByUsers (16.0.0)

AddByUsers
==========

Включить вкладки

Описание и сигнатура

Параметры

Пример

### Описание и сигнатура

```
CPullStack::AddByUsers(
	$arrayUserId, Array(
		'module_id' => 'im',
		'command' => 'ping',
		'params' => Array(
			'message' => 'test'
		),
	)
);Копировать
```

Метод отправляет сообщения группе пользователей. Метод статический.

Метод за один раз выбирает все каналы пользователей, и пакетами по N сообщений отправляет за раз. (Количество отправляемых сообщений зависит от [настройки модуля](http://dev.1c-bitrix.ru/user_help/settings/pull/settings.php) Push&Pull ).

Метод может отправлять push-уведомления на мобильные телефоны не отправляя для этого уведомления в мессенджер. Для этого нужно в массив параметров добавить ключ **push** с параметрами push-уведомления (для примера, таким образом ходят push-уведомления о новых сообщениях в чате).

### Параметры

| Параметр | Описание | С версии |
| --- | --- | --- |
| UserId | Массив получателей сообщения |  |
| module\_id | Модуль который отправляет команду |  |
| command | Команда которая будет обработана в JS |  |
| params | Любой набор данных, который будет обработан в JS |  |

### Пример

```
$users = [1,2,3];
\Bitrix\Pull\Push::add($users, Array(
	'module_id' => 'some',
	'push' => Array(
		'message' => $pushText,
		'expiry' => 0,
		'send_immediately' => 'Y' // если не нужно чтобы проходил фильтр, надо Y
	)
));Копировать
```

Рекомендуется использовать для решения задачи специальные уведомления. Они смогут дать возможность пользователю управлять что он хочет получать уведомление или push. Пример кода:

```
if (CModule::IncludeModule('im'))
{
	\CIMNotify::Add([
		"TO_USER_ID" => $USER->GetId(),
		"FROM_USER_ID" => 0, 
		"NOTIFY_TYPE" => IM_NOTIFY_SYSTEM, 
		"NOTIFY_MODULE" => "intranet", 
		"NOTIFY_EVENT" => "security_otp",
		"NOTIFY_MESSAGE" => "Совершена попытка входа в Ваш аккаунт через Мобильное устройство iPhone с IP 95.55.202.217 (Россия).[br][br]Код подтверждения входа: [b]722665[/b].[br][br] Используйте этот код для входа в ваш Битрикс24. Никому не передавайте его и не вводите на других сайтах![br][br]Если Вы не запрашивали код, срочно смените пароль в настройках.",
		"PUSH_MESSAGE" => "Код подтверждения входа: 722665. Если Вы не запрашивали код, срочно смените пароль в настройках.",
		"PUSH_IMPORTANT" => "N",
	]);
}Копировать
```

Новинки документации в соцсетях: