[Техподдержка](/api_help/support/index.php)

[Классы](/api_help/support/classes/index.php)

[CTicket](/api_help/support/classes/cticket/index.php)

Set (3.3.5)

Set
===

Включить вкладки

Описание и параметры

Примеры использования

### Описание и параметры

```
int
CTicket::Set(
	array arFields,
	int messageID,
	int ticketID,
	char(1) checkRights
	char(1) sendEmailToAuthor
	char(1) sendEmailToTechsupport
);Копировать
```

Метод создает новое обращение, либо модифицирует существующее в случае указания во втором параметре ID сообщения. Возвращает ID созданного обращения, либо ID модифицированного обращения. Метод нестатический.

#### Параметры метода

| Параметр | Описание | С версии |
| --- | --- | --- |
| arFields | Массив параметров обращения. В массиве допустимы следующие индексы:  * \*TITLE - заголовок обращения (обязательное поле при создании нового обращения) * MESSAGE - тело сообщения (обязательное поле при создании нового обращения) * IMAGE - массив описывающий загружаемое изображение; в массиве допустимые следующие индексы:   + name - исходное имя загружаемого файла   + type - тип загружаемого файла (например: "image/gif")   + tmp\_name - имя временного файла на сервере   + error - код ошибки ("0" - нет ошибок)   + size - размер загружаемого файла   + MODULE\_ID - идентификатор модуля ("support") * \*OWNER\_SID - символьный код автора обращения; можно указать любое значение идентифицирующее автора обращения - email, телефон, адрес и т.п. * \*OWNER\_USER\_ID - ID автора обращения (по умолчанию - ID текущего пользователя) * \*SOURCE\_SID - символьный код источника обращения (по умолчанию - "web") * \*CREATED\_MODULE\_NAME - идентификатор модуля из которого создаётся обращение (по умолчанию - "support") * \*\*MESSAGE\_AUTHOR\_SID - символьный код автора сообщения (можно указать любое значение идентифицирующее автора сообщения - email, телефон, адрес и т.п.) * \*\*MESSAGE\_AUTHOR\_USER\_ID - ID пользователя - автора сообщения (по умолчанию - ID текущего пользователя) * \*\*MESSAGE\_SOURCE\_SID - символьный код источника сообщения (по умолчанию - "web") * \*\*MODIFIED\_MODULE\_NAME - идентификатор модуля из которого обращение модифицируется (по умолчанию - "support") * \*\*HIDDEN - "Y" - сообщение будет добавлено как скрытое и будет видимо только сотрудникам техподдержки; "N" - сообщение будет добавлено видимым как для автора обращения так и для сотрудников техподдержки (по умолчанию) * CATEGORY\_SID - символьный код категории * CATEGORY\_ID - ID категории. * CRITICALITY\_SID - символьный код критичности * STATUS\_SID - символьный код статуса * MARK\_ID - ID оценки ответов * RESPONSIBLE\_USER\_ID - ID пользователя ответственного за обращение * SUPPORT\_COMMENTS - комментарий видимый только пользователям входящим в группу техподдержки * CLOSE - "Y" - обращение закрыть; "N" - обращение открыть * AUTO\_CLOSE\_DAYS - количество дней по истечении которых автоматически закрыть обращение если за это время от автора не поступило сообщения  \* - данное поле может быть использовано для создания новых обращений   \*\* - данное поле используется только при модификации существующих обращений. |  |
| MESSAGE\_ID | ID добавленного сообщения. Необязательный параметр. |  |
| TICKET\_ID | ID модифицируемого обращения. |  |
| CHECK\_RIGHTS | Флаг необходимости проверки прав текущего пользователя: "Y" - необходимо проверить права текущего пользователя под которым создаётся обращение либо модифицируется; "N" - обращения создавать и модифицировать независимо от прав текущего пользователя. Необязательный параметр. Значение по умолчанию - "Y". |  |
| SEND\_EMAIL\_TO\_AUTHOR | Необязательный параметр. Значение по умолчанию - "Y". | 3.3.11 |
| SEND\_EMAIL\_TO\_TECHSUPPORT | Необязательный параметр. Значение по умолчанию - "Y". | 3.3.11 |

### Примеры использования

```
Пример кода добавляющего новое обращение в техподдержку приходящего по EMail,
либо добавляющего новое сообщение в обращение если задан $TICKET_ID:
<?
require_once($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/prolog_before.php");
CModule::IncludeModule("support");
$arFields = array(
	"CREATED_MODULE_NAME"       => "mail",
	"MODIFIED_MODULE_NAME"      => "mail",
	"OWNER_SID"                 => "user@mail.ru",
	"SOURCE_SID"                => "email",
	"MESSAGE_AUTHOR_SID"        => "user@mail.ru",
	"MESSAGE_SOURCE_SID"        => "email",
	"TITLE"                     => "title",
	"MESSAGE"                   => "message"
);
//$TICKET_ID = 866;
$NEW_TICKET_ID = CTicket::Set($arFields, $MESSAGE_ID, $TICKET_ID, "N");
echo "MESSAGE_ID = ".$MESSAGE_ID;
?>Копировать
```

Новинки документации в соцсетях: