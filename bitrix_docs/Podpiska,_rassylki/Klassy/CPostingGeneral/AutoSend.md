[Подписка, рассылки](/api_help/subscribe/index.php)

[Классы](/api_help/subscribe/classes/index.php)

[CPostingGeneral](/api_help/subscribe/classes/cpostinggeneral/index.php)

AutoSend (доступен с 3.1.1)

AutoSend
========

Включить вкладки

Описание и параметры

Примеры использования

### Описание и параметры

```
CPosting::AutoSend(
	int ID = false,
	bool limit = false,
	string site_id = false
);Копировать
```

Метод для отправки выпуска с помощью cron'а или агента. Метод статический.

#### Примечание

При отправке с помощью агента учитывается кодировка в которой выпуск был составлен. отправка выпуска откладывается до хита на подходящий сайт.

#### Параметры

| Параметр | Описание | С версии |
| --- | --- | --- |
| ID | Идентификатор выпуска. Если параметр не указан или равен false, то будут отсылаться все выпуски в статусе "В процессе" время отправки которых меньше или равно текущему. В порядке возрастания времени отправки. |  |
| limit | Флажок ограничения количества отправляемых писем за один вызов. Если этот параметр указан и равен true количество писем отправляемых за один вызов данной функции ограничивается параметром "Количество писем для автоматической рассылки агентом за один запуск" в настройках модуля. При отправке выпуска с помощью агента (задан параметр ID) дополнительно ограничивается продолжительность отправки, которая определяется параметром в настройках модуля. |  |
| site\_id | Идентификатор сайта. Используется при отправке автоматически сгенерированных выпусков с помощью агентов. Если этот параметр указан, то его значение сравнивается с текущим значением константы SITE\_ID. Таким образом агент по отправке выполняется только в контексте сайта к которому привязана рубрика породившая выпуск. Это позволяет избежать проблемы пропуска картинок в html выпусках в случае многосайтовости организованной по второму варианту. | 7.0.4 |

#### Возвращаемые значения

Нет.

### Примеры использования

#### Пример использования в сценарии PHP для cron'а

```
#!/usr/bin/php
<?php
//Здесь необходимо указать ваш DOCUMENT_ROOT!
$_SERVER["DOCUMENT_ROOT"] = "/opt/www/html";
$DOCUMENT_ROOT = $_SERVER["DOCUMENT_ROOT"];
define("NO_KEEP_STATISTIC", true);
define("NOT_CHECK_PERMISSIONS", true);
set_time_limit(0);
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/prolog_before.php");
if (CModule::IncludeModule("subscribe"))
{
	$cPosting = new CPosting;
	$cPosting->AutoSend();
}
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/epilog_after.php");
?>Копировать
```

#### Пример использования в сценарии PHP для агента

```
<?
	CAgent::AddAgent("CPosting::AutoSend(".$ID.",true);", "subscribe", "N", 0, $post_arr["AUTO_SEND_TIME"], "Y", $post_arr["AUTO_SEND_TIME"]);
?>
<p class="notetext">Для отправки выпуска был создан агент.</p>Копировать
```

Новинки документации в соцсетях: