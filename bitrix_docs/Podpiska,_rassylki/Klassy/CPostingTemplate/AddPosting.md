[Подписка, рассылки](/api_help/subscribe/index.php)

[Классы](/api_help/subscribe/classes/index.php)

[CPostingTemplate](/api_help/subscribe/classes/cpostingtemplate/index.php)

AddPosting (доступен с 4.0.5)

AddPosting
==========

Включить вкладки

Описание и параметры

Примеры использования

### Описание и параметры

```
void
CPostingTemplate::AddPosting(
	array arRubric
);Копировать
```

Метод генерации выпуска на основании шаблона. Метод статический.

Сначала ищется и подключается языковой файл шаблона. Поиск осуществляется по пути <шаблон>>/lang/<идентификатор языка сайта к которому привязана рассылка>/template.php. Затем исполняется (подключается файл <шаблон>>/lang/template.php) шаблон. Весь вывод шаблона становится телом письма, а массив возвращаемый из него становится полями выпуска.

Если шаблон вернул не массив, а false, то выпуск не будет создан. При этом отметка времени о формировании будет сделана.

Если в этом массиве есть элемент FILES, к выпуску добавляются вложения. Элементами этого массива должны быть массивы формата:

```
Array(
	"name" => "название файла",
	"size" => "размер",
	"tmp_name" => "временный путь на сервере",
	"type" => "тип загружаемого файла"
);Копировать
```

Массив такого вида может быть сформирован с помощью функции [CFile::MakeFileArray](/api_help/main/reference/cfile/makefilearray.php).

А если в этом массиве есть элемент DO\_NOT\_SEND и его значение равно "Y", то выпуск не будет отправлен. Может быть использовано для отладки генерации или премодерации автоматических выпусков.

#### Параметры

| Параметр | Описание | C версии |
| --- | --- | --- |
| arRubric | Массив со значениями [полей объекта "Рассылка"](/api_help/subscribe/classes/crubric/crubric.fields.php). и дополнительными полями:   SITE\_ID - идентификатор сайта рассылки;   START\_TIME - время предыдущего запуска шаблона в формате "FULL" текущего сайта;   END\_TIME - время текущего запуска шаблона в формате "FULL" текущего сайта. |  |

#### Возвращаемые значения

Нет.

### Примеры использования

```
$rubrics = CRubric::GetList(array(), array("ID"=>$ID));
if($arRubric=$rubrics->Fetch())
{
	$arRubric["START_TIME"] = $START_TIME;
	$arRubric["END_TIME"] = $END_TIME;
	$arRubric["SITE_ID"] = $arRubric["LID"];
	CPostingTemplate::AddPosting($arRubric);
}Копировать
```

Новинки документации в соцсетях: